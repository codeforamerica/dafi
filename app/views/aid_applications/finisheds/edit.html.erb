<%= render 'aid_applications/navigation' %>

<div class="grid__item width-two-thirds shift-one-sixth">
  <div class="form-card">
    <div class="form-card__header">
      <h1>Card successfully disbursed</h1>
    </div>

    <div class="form-card__content">
      <p>Youâ€™re done! This application is fully processed.</p>

      <%= link_to "Return to home page", organization_dashboard_path(current_organization), class: 'button button--primary' %>
    </div>
  </div>
  <br>
  <div class="form-card">
    <h2>Activation code</h2>

    <div class="form-card__content notice--success">
      <p>The applicant has been sent their Activation Code
        via <%= activation_code_notification_description(@aid_application) %></p>
    </div>

    <p>The client <strong>must</strong> have their Activation Code to use their card.</p>
    <%= form_for(@aid_application, url: { action: :update }, builder: DafiFormBuilder, html: { novalidate: 'novalidate' }) do |f| %>
      <%= f.button "Re-send Activation Code",
                   type: 'submit',
                   name: 'form_action',
                   value: 'resend_code',
                   class: 'button button--secondary' %>
    <% end %>

    <div id="reveal-activation-code">
      <% if @reveal_activation_code %>
        <div class="notice--warning">
          <h3>Emergency access</h3>
          <p>The Activation Code for this payment card is:</p>

          <p><strong><%= @aid_application.payment_card.activation_code %></strong></p>

          <p><em>Your access has been logged. The Activation Code will be hidden again when this page is reloaded.</em></p>
        </div>
      <% else %>
        <p>If there is no way a client can receive the Activation Code themselves, you can access it and give it to
          them.</p>

        <%= button_to "Emergency access", { action: :reveal_activation_code }, method: :post, class: 'button button--secondary button--small', data: { confirm: "Are you sure you want to access a client's activation code? Emergency access should only be used if the client cannot receive the code themselves. This access will be recorded." } %>
      <% end %>
    </div>
  </div>
</div>
